<html>
<link rel="stylesheet" type="text/css" href="tcssx.css"> 
<div id="yeni" style="position: absolute; top: 50px; left: 30px; width: 700px; height: 400px; "> </div>



</html>



 <script type="text/javascript">
function table(idx){
			var _table=this;// table object saved in _table variable in order to use it inside other objects.
			this.jsonData="";//the data recived from database as a json format
			this.widths="";// table's cells widths
			this.header="";	//table's header 
			this.binds="";//it is array. every element of array attached orderly to one column of table
			this.dataarray=[];//the recieved json format is changed and stored as an array in here
			this.makeTable =function(){
											function create(element)
											//this function  creates table elements
											{
													var prefix={"table":"tl_","thead":"the_","tbody":"tb_","tfoot":"tf_","tr":"r_","th":"c_"};//, this has prefix for every table elment's id  that is created
													var id=prefix[element]+idx;//example if table id is 'gng' then  thead id becomes the_gng or for tfoot ,it becomes tf_gng and so on
													var result=document.getElementById(id)&&document.getElementById(id).remove()|| document.createElement(element);
													result.setAttribute("id",prefix[element]+idx);
													return result;
											} 
			
			var tbl =create('table');
			tbl.className="fixed_header";
			var thead=create('thead');
			var tbody=create('tbody');
			var tfoot=create('tfoot');
			var headRow = create('tr');
			var footRow =create ('tr');
			var tr = [];
			var td = [];
			var th = [];
																			for (z = 1; z <= Object.keys(this.header).length; z++) 
																			{	//in this loop, headers are created.
																				th[z] = document.createElement('th');  
																				th[z].id=z;
																				th[z].className="th_style";
																				th[z].style.width=this.widths[z];
																				th[z].innerHTML = this.header[z];
																				headRow .appendChild(th[z]);
																			}	
																				thead.appendChild(headRow);tbl.appendChild(thead);							
												

																	    var total = footRow.insertCell(0); 
																	    var total2 = footRow.insertCell(0); 
																		total2.colSpan=2;
																		total.colSpan=0;
																		
												 
																		var link_1= create("a");
																		link_1.innerHTML  = "ileri";
																	    link_1.onclick= function(){_table.pagination.nextPage()};
																		link_1.className="myButton"
																		
																	
																	var x= create("span");
													x.innerHTML=" "+this.pagination.currentpage+" "+this.pagination.getTotalpage();
																	
																	
																		var	link_2= create("a");
																	    link_2.innerHTML  = "Geri";
																		link_2.onclick= function(){_table.pagination.prevPage()};
																		link_2.className="myButton"
																		
																		
																		total.appendChild(link_2);
																		total.appendChild(x);
																		total.appendChild(link_1);
																		footRow.appendChild(total);
																		tfoot.appendChild(footRow);
																		tbl.appendChild(tfoot);										 
var xyz=this.pagination.start_point;
var rowcount=this.pagination.recordPerPage;	
					
var columncount=Object.keys(this.dataarray[0]).length;						
									   
									   
									    for (s =0 ; s <rowcount ; s++){
																			tr[s] = document.createElement('tr');
																	
										for (i = 0; i <columncount; i++) 
																
																			{	td[i] = document.createElement('td');  
																				td[i].id=i;
																				td[i].className="td_style";
																				td[i].style.width=this.widths[i];
																				if (this.dataarray[s+xyz]=== undefined) {break;}else{td[i].innerHTML =this.dataarray[s+xyz][i]}
																				tr[s].appendChild(td[i]);	
																			}
															  tbody.appendChild(tr[s]);
															}
															
															tbl.appendChild(tbody);
															document.getElementById('yeni').appendChild(tbl);
}   
			this.pagination={
							recordPerPage:5,// how many records a showed per page
							start_point:0,// this variable is used for dataarray varriable as a parameter
							currentpage:1,
							getTotalpage:function(){ // it calculates total page count 
									var c=Object.keys(_table.dataarray).length;//it shows how many records the array has
									return Math.ceil(c/this.recordPerPage);//total page
													},	
							nextPage:function(){ //this function is used for next page button
									
									if(this.currentpage <this.getTotalpage()) 
															{	
															this.currentpage++;
															this.start_point=this.start_point+this.recordPerPage;
													        _table.makeTable(idx);
															} 
															else
														
															{
															//when dataarray has finished , we go to databese for new record
															_table.Server.pagedirection=1;//it has three values  0 defult value ,1 for next  ,-1 for previous
															_table.Server.getDataFromServer();//gets data from database 
															_table.bagla();
															this.start_point=0;//
															this.currentpage=1;
															
															  _table.makeTable(idx);
															}
													},
								
								
								prevPage:function(){
															if(this.currentpage-2 <0) 
															{
															_table.Server.pagedirection=-1;
															_table.Server.getDataFromServer();
															 _table.bagla();
												
															this.start_point=0
															this.currentpage=1
															 _table.makeTable(idx);
															}
															else{
															this.currentpage--;
															this.start_point=this.start_point-this.recordPerPage;
															_table.makeTable(idx);}
																}
							}				
			this.Server={
			serverfile:"json.php",// PHP file is producing json data.
			recordLimit:14,
			start:0,//this variable is used on server side in sql query's limit command.
			pagedirection:0,
			getDataFromServer:function(){ 
											var xhr;	
											switch (this.pagedirection) {
									
									case 1:
									
									
									
									
											this.start=this.start+this.recordLimit; console.log(this.start);
											var data = "recordLimit="+this.recordLimit+"&startpoint="+ this.start;
											
											
											
											
									break;
									case -1:
										if(this.start-this.recordLimit<0)
										{
											alert("there is no record to next")
											}
										else{
										
										this.start=this.start-this.recordLimit;
										
											var data = "recordLimit="+this.recordLimit+"&startpoint="+ this.start;
										}
									break;
									
									case 0:
									//in first run, we send this parameter to server.
										var data = "recordLimit="+this.recordLimit+"&startpoint="+ this.start;
									break;
 								}		
				
				if (window.XMLHttpRequest){ xhr = new XMLHttpRequest();} else if (window.ActiveXObject) {
					xhr = new ActiveXObject("Microsoft.XMLHTTP");}
					xhr.onreadystatechange = function() {
					if (xhr.readyState == 4 && xhr.status == 200)
					{  	
					_table.jsonData= JSON.parse(xhr.responseText);
																	}
														}						
											xhr.open("POST",this.serverfile, false); 
											xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");	
											xhr.send(data);	
						}	
		
			}					
			this.bagla =function(){
/*example:

var jsondata=[{"name":"1","surname":"cel","age":"32","ayar":"14"},
{"name":"2","surname":"cik","age":"5","ayar":"14"},{"name":"3","surname":"celik","age":"31","ayar":"14"},
{"name":"4","surname":"celik","age":"31","ayar":"14"},{"name":"5","surname":"celik","age":"31","ayar":"14"},
{"name":"6","surname":"celik","age":"31","ayar":"14"},{"name":"7","surname":"celik","age":"31","ayar":"14"}];

var binds= ["%name%","%surname% ","%age% dir","%ayar%"];

 */
				for (c= 0; c <= Object.keys(this.jsonData).length-1 ; c++) {
				 // jsondata consist of objects, in first loop , for every c values  we choose a object 
				// for example  in first occurence ->>>{"name":"1","surname":"cel","age":"32","ayar":"14"}
				this.dataarray[c]=new Array();//two dimonsinal array is created.
					for (xy = 0; xy<= Object.keys(this.binds).length-1 ; xy++) {
							var cumlecik =this.binds[xy];
								 for (cc = 1; cc <= Object.keys(this.jsonData[0]).length ; cc++) {
									
								
												var searcword="%"+Object.keys(this.jsonData[0])[cc-1]+"%";// orderly, searchwords are %name%,%surname%,%age%...
												var newvalue=this.jsonData[c][Object.keys(this.jsonData[0])[cc-1]];
												var cumlecik = cumlecik.replace(searcword,newvalue);
							
											}
								 this.dataarray[c][xy]=cumlecik;			
								}
																			}

							}




}


var data=[{"name":"1","surname":"cel","age":"32","ayar":"14"},
{"name":"2","surname":"cik","age":"5","ayar":"14"},{"name":"3","surname":"celik","age":"31","ayar":"14"},
{"name":"4","surname":"celik","age":"31","ayar":"14"},{"name":"5","surname":"celik","age":"31","ayar":"14"},
{"name":"6","surname":"celik","age":"31","ayar":"14"},{"name":"7","surname":"celik","age":"31","ayar":"14"}];

var coloumn= ["%name%","%surname% ","%age% dir","%ayar%"];

var q = new table('g');
q.jsonData=data
q.widths={
			1:"152",
			2:"122", 
			3:"150"
				
}
q.header={
	        
			1:"HESAP NO",
			2:"HESAP name",
			3:"CEP"
		
		
			
}
//q.Server.getDataFromServer();
q.binds=coloumn;
q.bagla();
q.makeTable();






 		








  </script>
